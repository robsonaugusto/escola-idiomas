<h2 mat-dialog-title>{{ data?.mode === 'edit' ? 'Editar Estudante' : 'Novo Estudante' }}</h2>


<form #studentForm="ngForm" (ngSubmit)="onSubmit()" class="modal-form">
  <mat-dialog-content>
    <!-- Campo CPF -->
    <mat-form-field appearance="outline" class="full-width">
      <mat-label>CPF</mat-label>
      <input 
        matInput 
        name="cpf" 
        [(ngModel)]="estudante.cpf" 
        required 
        #cpfField="ngModel"
        [disabled]="isLoading"
        placeholder="000.000.000-00" />
      <mat-error *ngIf="cpfField.invalid && cpfField.touched">
        CPF é obrigatório
      </mat-error>
    </mat-form-field>

    <!-- Campo Nome -->
    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Nome</mat-label>
      <input 
        matInput 
        name="nome" 
        [(ngModel)]="estudante.nome" 
        required 
        #nomeField="ngModel"
        [disabled]="isLoading"
        placeholder="Nome completo do estudante" />
      <mat-error *ngIf="nomeField.invalid && nomeField.touched">
        Nome é obrigatório
      </mat-error>
    </mat-form-field>

    <!-- Campo Data de Nascimento -->
    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Data de Nascimento</mat-label>
      <input 
        matInput 
        name="dataNascimento" 
        [(ngModel)]="estudante.dataNascimento" 
        type="date"
        [disabled]="isLoading" />
    </mat-form-field>

    <!-- Campo CEP -->
    <mat-form-field appearance="outline" class="full-width">
      <mat-label>CEP</mat-label>
      <input 
        matInput 
        name="cep" 
        [(ngModel)]="estudante.cep" 
        [disabled]="isLoading"
        placeholder="00000-000" />
    </mat-form-field>

    <!-- Campo Logradouro -->
    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Logradouro</mat-label>
      <input 
        matInput 
        name="logradouro" 
        [(ngModel)]="estudante.logradouro" 
        [disabled]="isLoading"
        placeholder="Rua, Avenida, etc." />
    </mat-form-field>

    <!-- Campo Número -->
    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Número</mat-label>
      <input 
        matInput 
        name="numeroCasa" 
        [(ngModel)]="estudante.numeroCasa" 
        [disabled]="isLoading"
        placeholder="Número da residência" />
    </mat-form-field>

    <!-- Campo Bairro -->
    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Bairro</mat-label>
      <input 
        matInput 
        name="bairro" 
        [(ngModel)]="estudante.bairro" 
        [disabled]="isLoading" />
    </mat-form-field>

    <!-- Campo Estado -->
    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Estado</mat-label>
      <input 
        matInput 
        name="estado" 
        [(ngModel)]="estudante.estado" 
        [disabled]="isLoading"
        placeholder="Ex: São Paulo, Rio de Janeiro" />
    </mat-form-field>

    <!-- Campo Cidade -->
    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Cidade</mat-label>
      <input 
        matInput 
        name="cidade" 
        [(ngModel)]="estudante.cidade" 
        [disabled]="isLoading" />
    </mat-form-field>

    <!-- Campo Telefone -->
    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Telefone</mat-label>
      <input 
        matInput 
        name="telefone" 
        [(ngModel)]="estudante.telefone" 
        [disabled]="isLoading"
        placeholder="(00) 00000-0000" />
    </mat-form-field>

    <!-- Campo Email -->
    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Email</mat-label>
      <input 
        matInput 
        name="email" 
        [(ngModel)]="estudante.email" 
        type="email"
        required
        #emailField="ngModel"
        [disabled]="isLoading"
        placeholder="exemplo@email.com" />
      <mat-error *ngIf="emailField.invalid && emailField.touched">
        <span *ngIf="emailField.errors?.['required']">Email é obrigatório</span>
        <span *ngIf="emailField.errors?.['email']">Email deve ter um formato válido</span>
      </mat-error>
    </mat-form-field>
  </mat-dialog-content>

  <mat-dialog-actions align="end">
    <button 
      mat-button 
      type="button" 
      (click)="onCancel()" 
      [disabled]="isLoading">
      Cancelar
    </button>
    <button 
      mat-raised-button 
      color="primary" 
      type="submit" 
      [disabled]="!isFormValid() || isLoading">
      <span *ngIf="isLoading">Processando...</span>
      <span *ngIf="!isLoading">{{ data?.mode === 'edit' ? 'Atualizar' : 'Salvar' }}</span>
    </button>
  </mat-dialog-actions>
</form>